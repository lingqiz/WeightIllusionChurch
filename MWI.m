%% MWI Equal Weight Input

load('EqualWeightSimulation.mat');
inputCondition = [-0.5, -1.3, -1.5, -1.6, -1.9, -2.5, -3, -3.2];

% Mean Estimate (Effect of MWI)
inputWeight = 700; 
meanEst = mean(simulationDraws, 2);

% Plot mean estimate (log ratio & weight)
figure;

subplot(1, 2, 1);
plot(inputCondition, meanEst, '-o'); 

hold on;
plot([-4, 0], [0, 0], '--');

xlabel('Log Density Ratio');
ylabel('Log Weight Ratio');

yl = inputWeight .* exp(ylim);
subplot(1, 2, 2);
plot(inputCondition, inputWeight .* exp(meanEst), '-o');

hold on;
plot([-4, 0], [inputWeight, inputWeight], '--');

xlabel('Log Density Ratio');
ylabel('Estimated Weight');
ylim(yl);


figure;
for idx = 1 : length(inputCondition)
    subplot(4, 2, idx);
    histogram(simulationDraws(idx, :), 'BinWidth', 0.1, 'Normalization', 'probability');
    xlim([-3, 2]);
    title(num2str(inputCondition(idx)));
end

%% MWI Unequal Weight Input with Density Prior Centered at -1.95
figure; hold on;

load('UnequalWeightSimulation.mat');
inputCondition = [0, -0.05, -0.1, -0.15, -0.2];

meanEst = mean(simDraws, 2);
plot(inputCondition, meanEst, '-o');
plot([-4, 0], [0, 0], '--');

set(gca, 'XDir','reverse')
xlabel('Input Weight Ratio'); ylabel('Log Weight Ratio');
xlim([-0.21, 0.01]); ylim([-0.05, 0.13]);

%% Parameter Search

data1 = [0.02511373966583862 0.03466968330593683 0.03778109056842569 0.04212457211243148 0.04876966301464548 0.05500269095834472 0.056814706955011125 0.06532083246251523 0.07150285217317127 0.07268717237499332 0.07770308895163534 0.02790458849105932 0.032328560129027815 0.033111990596885514 0.04174598086184755 0.04693171377579517 0.05119161087323498 0.058246257747175206 0.06637538850609301 0.07094037368307092 0.0766260598961381 0.07863713574001396 0.029223136917577556 0.03224855856927626 0.03548667407566863 0.04379977371936312 0.044853603017538345 0.05081439239293316 0.05757156926037389 0.06228249531136682 0.07391931521462321 0.07195209841165234 0.08272206994277954 0.02884081744144987 0.031937907569984214 0.03705845262048157 0.04224749413334039 0.04627688735498874 0.049322845310182 0.05528808461873787 0.061460378967597463 0.07130051814937595 0.0726190609565263 0.07730016921831018 0.030552374929812755 0.03516874496931545 0.0412689868985943 0.0416176724462847 0.04818476072822295 0.0515125900442891 0.05949020770266753 0.06677703790499095 0.06730315615417198 0.07239349418175292 0.07486015251637364 0.025784643566200263 0.033701059385628646 0.03500050959219788 0.04116047604093865 0.04706266069737748 0.05281873837964931 0.05467023112285585 0.0636514736205036 0.06450342463318605 0.06963989678922733 0.07961220998383231 0.025805783716251467 0.03278533457169418 0.03780153037581172 0.04644496934516452 0.04992227170933275 0.0550215321913181 0.05529296772735435 0.06576755068203963 0.06595189383910069 0.0765226720042672 0.08401854711985163 0.03267868562418255 0.034734718964258726 0.03585814929039809 0.04282363861783105 0.04800179587841863 0.05326124423876668 0.05858703918441062 0.06508926156330332 0.06867964152053464 0.07894118024531152 0.07754115154644015 0.02725991747358564 0.03176409286386102 0.03951765377022222 0.04066885569836991 0.047706289314793655 0.05451999821410936 0.05643109476311167 0.06147128189554312 0.06886681845337966 0.07552807408976375 0.08091474639073028 0.02668177611492643 0.031621210642800233 0.040007038489837575 0.043221178335660734 0.04795574720493 0.05337151853858469 0.05498099285506019 0.06385161254740705 0.07016385197266278 0.07194445248724589 0.08117232744118504 0.028918230865632017 0.03433420496975255 0.03393308502357698 0.04375919618256131 0.04776251211518035 0.05230577699902285 0.05785273081961511 0.06464095432908899 0.07106808184287988 0.075240588515882 0.07790706482666165];
data2 = [0.02934634918836323 0.03567902689709908 0.040087308037605976 0.04360907078225197 0.04937156617375923 0.05143902520925629 0.05420862057277949 0.06165936518700826 0.06103863570833886 0.07441742779505668 0.07123214239611791 0.03059350555294484 0.030634614837154107 0.03632946239925328 0.043825866471215946 0.04693944563794725 0.054115269683017914 0.05917410676146488 0.061864448910389634 0.06612631844904773 0.071437859171211 0.07408622589815603 0.02839610909864897 0.032831207962864366 0.03861436974448788 0.04285958324207248 0.04965991606997987 0.05117447333935769 0.058635212119446875 0.06552500535627534 0.06796754757523839 0.07001343208239856 0.07240947321200897 0.02833741538080118 0.03142109297151429 0.03996110446802904 0.043537163701642664 0.05149562520146319 0.05036188583279612 0.05961412489788032 0.06112961594200043 0.07129100308826293 0.06902297960634644 0.07659806448660543 0.026880392668960577 0.03391148687454555 0.03568766618463666 0.0454335443734265 0.0477689683109687 0.05432587351053763 0.05613132151119205 0.06375221199468002 0.06667923803155407 0.07289344346348987 0.07499683563941623 0.02775076875024787 0.03186941444624364 0.03924433281251311 0.04483658728165619 0.043980230767065254 0.05200830872042324 0.0589678801559361 0.06307579763630672 0.07018961176944395 0.07676342597520457 0.07340622766200665 0.028738290938785455 0.0347866798055742 0.032647093925185465 0.04027837570897689 0.048822494376224906 0.057520173944146234 0.05731862787209127 0.0642379862354853 0.06481372022738834 0.07097250368370611 0.0716440190877076 0.02961167085491951 0.03340284600981026 0.03484825559132182 0.046341843039570015 0.044943766721907134 0.054834353729380766 0.055344750967426797 0.06316111304418516 0.06603416740629256 0.07078457102648776 0.07651025800411354 0.030450063398379724 0.03254839125622125 0.034229498708448436 0.04403575267568077 0.0475943278180343 0.05476920534835863 0.05946103676344934 0.064516630307303 0.06613098117580946 0.06610853032251117 0.074517495092719 0.03156210521134843 0.03315560916926279 0.03626907099601387 0.042939347805097686 0.04963036976775477 0.05042809450008239 0.05760800583644545 0.06217220030108368 0.0658000683785591 0.07177371759492594 0.0670644556131313 0.029538290458130768 0.03440676970168873 0.04079734949448093 0.042634247590001374 0.0468330136077374 0.05293285713431795 0.05847502430485514 0.062053892575354895 0.06872522486749179 0.06721969353845395 0.07551096921372463];

